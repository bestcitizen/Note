---
layout: post
date: 2024-12-31
title: Apache Kafka
---


- Apache Kafka는 LinkedIn에서 개발한 분산 스트리밍 플랫폼입니다.
- 실시간으로 데이터 스트림을 게시하고 구독하며 저장하고 처리할 수 있는 시스템을 제공합니다.
- 주로 대용량 실시간 로그 처리, 이벤트 스트리밍에 사용됩니다.



## 주요 개념


### 메시지와 토픽

- Kafka는 메시지(레코드)를 토픽으로 분류합니다.
- 토픽은 메시지를 저장하는 논리적 채널입니다.
- 각 토픽은 여러 파티션으로 분할될 수 있으며, 이를 통해 병렬 처리와 확장성을 제공합니다.


### 프로듀서와 컨슈머 

프로듀서는 메시지를 토픽에 게시하는 클라이언트 애플리케이션입니다. 컨슈머는 토픽을 구독하여 메시지를 읽는 클라이언트입니다. 컨슈머 그룹을 통해 여러 컨슈머가 협력하여 메시지를 처리할 수 있습니다.

### 브로커와 주키퍼

브로커는 Kafka 서버로, 메시지를 수신하고 저장하며 전달합니다. 주키퍼는 브로커의 메타데이터를 관리하고 클러스터 구성을 조정합니다.

## 주요 특징

### 고가용성

Kafka는 여러 브로커에 걸쳐 데이터를 복제함으로써 장애 허용성을 제공합니다. 리더-팔로워 모델을 사용하여 데이터 일관성을 보장합니다.

### 확장성

파티션 기반 아키텍처로 인해 수평적 확장이 용이합니다. 브로커를 추가하여 처리량을 늘릴 수 있으며, 컨슈머 그룹을 통해 병렬 처리가 가능합니다.

### 영속성

메시지는 디스크에 저장되며, 구성된 보존 기간 동안 유지됩니다. 이는 시스템 장애 시에도 데이터 손실을 방지하고, 과거 데이터의 재처리를 가능하게 합니다.

## 활용 사례

1. 실시간 분석: 사용자 활동 로그, 센서 데이터 등의 실시간 처리
2. 로그 수집: 분산 시스템의 로그를 중앙 집중화
3. 이벤트 소싱: 마이크로서비스 간 이벤트 기반 통신
4. 스트림 처리: 실시간 데이터 파이프라인 구축

## 구성 및 튜닝

### 주요 설정

```properties
# 브로커 설정
broker.id=0
listeners=PLAINTEXT://localhost:9092
log.dirs=/tmp/kafka-logs

# 토픽 기본 설정
num.partitions=3
default.replication.factor=3

# 메시지 보존 설정
log.retention.hours=168
log.retention.bytes=1073741824
```

### 성능 최적화

1. 파티션 수 조정: 처리량에 맞춰 적절한 파티션 수 설정
2. 배치 처리: 프로듀서의 배치 설정을 통한 처리량 개선
3. 압축 활용: 네트워크 대역폭 절약을 위한 메시지 압축

## 모니터링

주요 모니터링 지표:
- 브로커 상태와 리더 선출
- 파티션 복제 상태
- 컨슈머 지연(Consumer Lag)
- 디스크 사용량
- 네트워크 처리량












## Reference

- <https://velog.io/@holicme7/Apache-Kafka-Kafka-Streams-%EB%9E%80>